{"version":3,"sources":["uni-app:///main.js","webpack:///E:/work/mianku/pages/news/customer-service.vue?035b","webpack:///E:/work/mianku/pages/news/customer-service.vue?0f38","webpack:///E:/work/mianku/pages/news/customer-service.vue?495b","webpack:///E:/work/mianku/pages/news/customer-service.vue?272b","uni-app:///pages/news/customer-service.vue","webpack:///E:/work/mianku/pages/news/customer-service.vue?cb25","webpack:///E:/work/mianku/pages/news/customer-service.vue?88fa"],"names":["wx","__webpack_require_UNI_MP_PLUGIN__","__webpack_require__","createPage","Page"],"mappings":"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","file":"pages/news/customer-service.js","sourcesContent":["import 'uni-pages';wx.__webpack_require_UNI_MP_PLUGIN__ = __webpack_require__;\nimport Vue from 'vue'\nimport Page from './pages/news/customer-service.vue'\ncreatePage(Page)","import { render, staticRenderFns, recyclableRender, components } from \"./customer-service.vue?vue&type=template&id=a7c1c04e&scoped=true&\"\nvar renderjs\nimport script from \"./customer-service.vue?vue&type=script&lang=js&\"\nexport * from \"./customer-service.vue?vue&type=script&lang=js&\"\nimport style0 from \"./customer-service.vue?vue&type=style&index=0&id=a7c1c04e&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../soft/HBuilderX.3.3.5.20211229/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"a7c1c04e\",\n  null,\n  false,\n  components,\n  renderjs\n)\n\ncomponent.options.__file = \"pages/news/customer-service.vue\"\nexport default component.exports","export * from \"-!../../../../soft/HBuilderX.3.3.5.20211229/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/templateLoader.js??vue-loader-options!../../../../soft/HBuilderX.3.3.5.20211229/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--16-0!../../../../soft/HBuilderX.3.3.5.20211229/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../soft/HBuilderX.3.3.5.20211229/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-uni-app-loader/page-meta.js!../../../../soft/HBuilderX.3.3.5.20211229/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../soft/HBuilderX.3.3.5.20211229/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./customer-service.vue?vue&type=template&id=a7c1c04e&scoped=true&\"","var components\nvar render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar recyclableRender = false\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns, recyclableRender, components }","import mod from \"-!../../../../soft/HBuilderX.3.3.5.20211229/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../soft/HBuilderX.3.3.5.20211229/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../soft/HBuilderX.3.3.5.20211229/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../soft/HBuilderX.3.3.5.20211229/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../soft/HBuilderX.3.3.5.20211229/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./customer-service.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../soft/HBuilderX.3.3.5.20211229/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../soft/HBuilderX.3.3.5.20211229/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../soft/HBuilderX.3.3.5.20211229/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../soft/HBuilderX.3.3.5.20211229/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../soft/HBuilderX.3.3.5.20211229/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./customer-service.vue?vue&type=script&lang=js&\"","<!--联系客服-->\r\n<template>\r\n\t<view class=\"page\">\r\n\t\t<!-- 聊天信息框 start -->\r\n\t\t<view class=\"chat-wrapper\" v-if=\"chatList.length\" :style=\"{'height': contentViewHeight + 'px'}\">\r\n\t\t\t<scroll-view scroll-y=\"true\" :scroll-with-animation=\"true\" :scroll-top=\"scrollTop\" class=\"chat-scroll\"\r\n\t\t\t\t:style=\"{'height': contentViewHeight + 'px'}\" @scrolltoupper=\"scrollToTop\">\r\n\t\t\t\t<image src=\"@/static/image/loading.png\" class=\"load-icon-wrapper\" v-if=\"showLoad\"></image>\r\n\t\t\t\t<view class=\"chat-items\" v-for=\"(item,index) in chatList\" :key=\"index\">\r\n\t\t\t\t\t<view class=\"chat-items-time\">{{item.createdAt}}</view>\r\n\t\t\t\t\t<view :class=\"['chat-items-body',userId == item.uid?'chat-end':'chat-start']\">\r\n\t\t\t\t\t\t<view class=\"chat-items-icon\" v-if=\"userId !== item.uid\">\r\n\t\t\t\t\t\t\t<image src=\"https://mkhotel.oss-cn-shanghai.aliyuncs.com/static/image/logo-jxw.png\"\r\n\t\t\t\t\t\t\t\tmode=\"widthFix\" class=\"user-img\"></image>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t<view class=\"chat-items-msg-wrapper\">\r\n\t\t\t\t\t\t\t<view :class=\"['chat-items-msg',userId == item.uid?'on':'un']\">\r\n\t\t\t\t\t\t\t\t<text style=\"word-wrap: break-word;\">{{item.msg}}</text>\r\n\t\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t\t<view class=\"chat-items-icon\" v-if=\"userId == item.uid\">\r\n\t\t\t\t\t\t\t<image :src=\"item.face\" mode=\"widthFix\" class=\"user-img\"></image>\r\n\t\t\t\t\t\t</view>\r\n\t\t\t\t\t</view>\r\n\t\t\t\t</view>\r\n\t\t\t\t<view v-if=\"inputBottom == 0\" :style=\"{'height': 'calc(' + inputBottom + 80 + 'px)'}\"></view>\r\n\t\t\t\t<view :style=\"{'height': 'calc('+ inputBottom +'px + 80px)'}\"></view>\r\n\t\t\t</scroll-view>\r\n\t\t</view>\r\n\t\t<!-- 聊天信息框 end -->\r\n\r\n\t\t<!-- 发布消息框 start -->\r\n\t\t<view class=\"bottom-input-wrapper\">\r\n\t\t\t<input type=\"text\" class=\"input\" :confirm-hold=\"true\" placeholder=\"请输入你要发送的内容\"\r\n\t\t\t\tplaceholder-class=\"input-class\" @focus=\"inputFocus\" @blur=\"inputBlur\" @confirm=\"publishMsg\"\r\n\t\t\t\tv-model=\"inputmsg\">\r\n\t\t\t<view class=\"publish-btn\" @click=\"publishMsg\">发送</view>\r\n\t\t</view>\r\n\t\t<!-- 发布消息框 end -->\r\n\r\n\t\t<view v-if=\"!delay_timer && !!delay_timer\"></view>\r\n\t\t<view v-if=\"!mitemHeight && !!mitemHeight\"></view>\r\n\t</view>\r\n</template>\r\n\r\n<script>\r\n\timport {\r\n\t\thandTime\r\n\t} from '@/utils/functionHandle.js'\r\n\timport {\r\n\t\tgetUserImList,\r\n\t\tgetUserImAdd\r\n\t} from '@/utils/request/manage.js'\r\n\timport {\r\n\t\tuserDetail\r\n\t} from '@/utils/request/manage.js'\r\n\r\n\timport {\r\n\t\tmapState,\r\n\t\tmapMutations\r\n\t} from 'vuex'\r\n\texport default {\r\n\t\tdata() {\r\n\t\t\treturn {\r\n\t\t\t\ttype: '',\r\n\t\t\t\tuserId: 0, // 该用户id\r\n\t\t\t\tuserinfo: {},\r\n\t\t\t\tface: '', // 该用户头像\r\n\t\t\t\tchatList: [],\r\n\t\t\t\tinputBottom: 0,\r\n\t\t\t\tinputmsg: '',\r\n\t\t\t\tscrollTop: 0,\r\n\t\t\t\tmitemHeight: 0,\r\n\t\t\t\tcontentViewHeight: 0,\r\n\t\t\t\tshowLoad: false,\r\n\t\t\t\tdelay_timer: {}, // 定时器\r\n\t\t\t}\r\n\t\t},\r\n\t\tcomputed: {\r\n\t\t\t...mapState(['hasLogin'])\r\n\t\t},\r\n\t\t// onLoad() {\r\n\t\t// \tthis.getUserDetail()\r\n\t\t// },\r\n\t\tonShow() {\r\n\t\t\tuni.onKeyboardHeightChange(res => {\r\n\t\t\t\tconsole.log(\"aaaaa\", res.height)\r\n\t\t\t\tif (res.height > 0) {\r\n\t\t\t\t\tthis.inputBottom = res.height - 80\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.inputBottom = 0\r\n\t\t\t\t}\r\n\t\t\t})\r\n\t\t},\r\n\t\tonUnload() {\r\n\t\t\tconsole.log('清除定时器')\r\n\t\t\tclearInterval(this.delay_timer)\r\n\t\t},\r\n\t\tmounted() {\r\n\t\t\tconst resSystem = uni.getSystemInfoSync()\r\n\t\t\tconsole.log('resSystem: ', resSystem)\r\n\t\t\tthis.contentViewHeight = resSystem.windowHeight //像素   因为给出的是像素高度 然后我们用的是rpx  所以换算一下 \r\n\t\t\tlet createdAt = handTime()\r\n\t\t\t// 第一次进入该页面，自动发一条消息\r\n\t\t\tlet isFirstInKefu = uni.getStorageSync('chatFlag')\r\n\t\t\tconsole.log('isFirstInKefu: ', isFirstInKefu)\r\n\t\t\tif (!isFirstInKefu) {\r\n\t\t\t\t// setTimeout(() => {\r\n\t\t\t\t// \t\t\t\t\tthis.chatList.push({id:9999,uid:this.userId,face: this.face,userName: userName,msg: '您好，有些问题想要咨询你',createdAt: createdAt})\r\n\t\t\t\t// \t\t\t\t},500)\r\n\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t\tthis.chatList.push({\r\n\t\t\t\t\t\tid: 99998,\r\n\t\t\t\t\t\tuid: 1,\r\n\t\t\t\t\t\tface: 'https://mkhotel.oss-cn-shanghai.aliyuncs.com/static/image/logo-jxw.png',\r\n\t\t\t\t\t\tuserName: '太子山',\r\n\t\t\t\t\t\tmsg: '您好,请问有什么可以帮您？',\r\n\t\t\t\t\t\tcreatedAt: createdAt\r\n\t\t\t\t\t})\r\n\t\t\t\t\tlet array = [{\r\n\t\t\t\t\t\tid: 99998,\r\n\t\t\t\t\t\tuid: 1,\r\n\t\t\t\t\t\tface: 'https://mkhotel.oss-cn-shanghai.aliyuncs.com/static/image/logo-jxw.png',\r\n\t\t\t\t\t\tuserName: '太子山',\r\n\t\t\t\t\t\tmsg: '您好,请问有什么可以帮您？',\r\n\t\t\t\t\t\tcreatedAt: createdAt\r\n\t\t\t\t\t}]\r\n\t\t\t\t\tuni.setStorage({\r\n\t\t\t\t\t\tkey: 'chatFlag',\r\n\t\t\t\t\t\tdata: array,\r\n\t\t\t\t\t\tsuccess(res) {\r\n\t\t\t\t\t\t\tconsole.log('res: ', res)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t})\r\n\t\t\t\t}, 1000)\r\n\t\t\t}\r\n\t\t\tthis.initData(0, 0)\r\n\t\t\tthis.getUserDetail()\r\n\t\t\tthis.delay_timer = setInterval(() => {\r\n\t\t\t\tthis.askNewMsg(this.chatList[this.chatList.length-1].id)\r\n\t\t\t\t// this.initData(0,0)\r\n\t\t\t},15000)\r\n\t\t},\r\n\t\tmethods: {\r\n\t\t\tasync getUserDetail() {\r\n\t\t\t\tconst {\r\n\t\t\t\t\tdata\r\n\t\t\t\t} = await userDetail()\r\n\t\t\t\tthis.userinfo = data.data\r\n\t\t\t\tthis.userId = this.userinfo.id\r\n\t\t\t\tconsole.log(\"userinfo\", data.data, this.userId)\r\n\t\t\t},\r\n\t\t\tasync initData(tid, type) {\r\n\r\n\t\t\t\tconst {\r\n\t\t\t\t\tdata: res\r\n\t\t\t\t} = await getUserImList(tid, type)\r\n\t\t\t\tconsole.log('res: ', res)\r\n\t\t\t\tif (res.code == -1) {\r\n\t\t\t\t\tthis.showLoad = false\r\n\t\t\t\t\treturn this.$api.msg('获取聊天信息列表失败!' + res.msg, 'none')\r\n\t\t\t\t}\r\n\t\t\t\tconsole.log(\"res.data.rs.length\", res.data.rs.length)\r\n\t\t\t\tif (res.data.rs.length) {\r\n\t\t\t\t\tif (type == 1) {\r\n\t\t\t\t\t\t// 历史消息\r\n\t\t\t\t\t\tthis.chatList = res.data.rs.reverse().concat(this.chatList)\r\n\r\n\t\t\t\t\t} else {\r\n\t\t\t\t\t\t// 最新消息\r\n\t\t\t\t\t\tthis.chatList = this.chatList.concat(res.data.rs.reverse())\r\n\t\t\t\t\t}\r\n\t\t\t\t\tif (res.data.rs.length < 10) {\r\n\t\t\t\t\t\tlet isFirstInKefu = uni.getStorageSync('chatFlag')\r\n\t\t\t\t\t\tif (isFirstInKefu) {\r\n\t\t\t\t\t\t\tthis.chatList = isFirstInKefu.concat(this.chatList)\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t\tthis.showLoad = false\r\n\t\t\t\t\t}\r\n\t\t\t\t} else {\r\n\t\t\t\t\tlet isFirstInKefu = uni.getStorageSync('chatFlag')\r\n\t\t\t\t\tif (isFirstInKefu) {\r\n\t\t\t\t\t\tthis.chatList = isFirstInKefu.concat(this.chatList)\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\t\t\t\tif (type == 0) {\r\n\t\t\t\t\tthis.$nextTick(function() {\r\n\t\t\t\t\t\tthis.pageScrollToBottom()\r\n\t\t\t\t\t})\r\n\t\t\t\t}\r\n\r\n\r\n\t\t\t},\r\n\t\t\t// 每隔15s请求最新的消息\r\n\t\t\tasync askNewMsg(tid) {\r\n\t\t\t\tconst {\r\n\t\t\t\t\tdata: res\r\n\t\t\t\t} = await getUserImList(tid, 0)\r\n\t\t\t\tconsole.log('最新的消息res: ', res)\r\n\t\t\t\tif (res.code == 1) {\r\n\t\t\t\t\treturn this.$api.msg('获取聊天信息列表失败!' + res.msg, 'none')\r\n\t\t\t\t}\r\n\t\t\t\tif (res.data.rs.length) {\r\n\t\t\t\t\tthis.chatList = this.chatList.concat(res.data.rs.reverse())\r\n\t\t\t\t}\r\n\t\t\t},\r\n\t\t\tinputFocus(e) {\r\n\t\t\t\tif (e.detail.height > 0) {\r\n\t\t\t\t\tthis.inputBottom = e.detail.height - 77\r\n\t\t\t\t} else {\r\n\t\t\t\t\tthis.inputBottom = 0\r\n\t\t\t\t}\r\n\t\t\t\tthis.$nextTick(function() {\r\n\t\t\t\t\tthis.pageScrollToBottom()\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tinputBlur() {\r\n\t\t\t\tthis.inputBottom = 0\r\n\t\t\t},\r\n\t\t\t// 发布消息\r\n\t\t\tasync publishMsg() {\r\n\t\t\t\tif (!this.inputmsg.trim()) return\r\n\t\t\t\tconst {\r\n\t\t\t\t\tdata: res\r\n\t\t\t\t} = await getUserImAdd(this.inputmsg)\r\n\t\t\t\tconsole.log('res: ', res)\r\n\t\t\t\tif (res.code == 1) {\r\n\t\t\t\t\treturn this.$api.msg('发送信息失败!' + res.msg, 'none')\r\n\t\t\t\t}\r\n\t\t\t\tlet obj = {\r\n\t\t\t\t\tid: res.data.id,\r\n\t\t\t\t\tuid: this.userId,\r\n\t\t\t\t\tface: this.face,\r\n\t\t\t\t\tmsg: this.inputmsg,\r\n\t\t\t\t\tcreatedAt: handTime()\r\n\t\t\t\t}\r\n\t\t\t\tthis.chatList.push(obj)\r\n\t\t\t\tthis.inputmsg = ''\r\n\t\t\t\tthis.$nextTick(function() {\r\n\t\t\t\t\tthis.pageScrollToBottom()\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tpageScrollToBottom() {\r\n\t\t\t\tlet _self = this\r\n\t\t\t\tlet query = uni.createSelectorQuery();\r\n\t\t\t\tquery.selectAll('.chat-items').boundingClientRect();\r\n\t\t\t\tquery.select('.chat-scroll').boundingClientRect();\r\n\t\t\t\tquery.exec((res) => {\r\n\t\t\t\t\t_self.mitemHeight = 0\r\n\t\t\t\t\tres[0].forEach((rect) => _self.mitemHeight = _self.mitemHeight + rect.height +\r\n\t\t\t\t\t\t80) //获取所有内部子元素的高度\r\n\t\t\t\t\tconsole.log('inputBottom', _self.inputBottom)\r\n\t\t\t\t\t_self.mitemHeight = _self.mitemHeight + _self.inputBottom\r\n\t\t\t\t\tconsole.log('mitemHeight', _self.mitemHeight)\r\n\t\t\t\t\tconsole.log('contentViewHeight', _self.contentViewHeight)\r\n\t\t\t\t\t// 因为vue的虚拟DOM 每次生成的新消息都是之前的，所以采用异步setTimeout\r\n\t\t\t\t\tsetTimeout(() => {\r\n\t\t\t\t    if (_self.mitemHeight > (_self.contentViewHeight)) { //判断子元素高度是否大于显示高度\r\n\t\t\t\t\t\t\t_self.scrollTop = _self.mitemHeight - _self\r\n\t\t\t\t\t\t\t\t.contentViewHeight //用子元素的高度减去显示的高度就获益获得序言滚动的高度\r\n\t\t\t\t\t\t}\r\n\t\t\t\t\t}, 100)\r\n\t\t\t\t})\r\n\t\t\t},\r\n\t\t\tscrollToTop() {\r\n\t\t\t\tif (this.chatList[0].id == 99998) {\r\n\t\t\t\t\treturn\r\n\t\t\t\t}\r\n\t\t\t\tconsole.log('滑到顶部了')\r\n\t\t\t\tthis.showLoad = true\r\n\t\t\t\tthis.initData(this.chatList[0].id, 1)\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n</script>\r\n\r\n<style lang=\"scss\" scoped>\r\n\t@-webkit-keyframes load {\r\n\t\t0% {\r\n\t\t\ttransform: rotate(0deg);\r\n\t\t}\r\n\r\n\t\t100% {\r\n\t\t\ttransform: rotate(360deg);\r\n\t\t}\r\n\t}\r\n\r\n\t// 聊天信息框 start\r\n\t.chat-wrapper {\r\n\t\tposition: relative;\r\n\t\theight: 100vh;\r\n\t\tbackground-color: #F6F7FB;\r\n\r\n\t\t.chat-scroll {\r\n\t\t\theight: 100vh;\r\n\t\t\tpadding: 0 0 env(safe-area-inset-bottom);\r\n\t\t}\r\n\r\n\t\t.load-icon-wrapper {\r\n\t\t\tdisplay: block;\r\n\t\t\twidth: 30rpx;\r\n\t\t\theight: 30rpx;\r\n\t\t\tmargin-right: 12rpx;\r\n\t\t\tanimation: load 0.8s cubic-bezier(.37, 1.08, .7, .74) infinite;\r\n\t\t\tmargin: 0 auto 20rpx;\r\n\t\t}\r\n\r\n\t\t.chat-items {\r\n\t\t\tmargin-bottom: 20rpx;\r\n\t\t\tpadding: 0 20rpx;\r\n\r\n\t\t\t.chat-items-time {\r\n\t\t\t\twidth: 100%;\r\n\t\t\t\ttext-align: center;\r\n\t\t\t\tfont-size: 24rpx;\r\n\t\t\t\tcolor: #999;\r\n\t\t\t\tmargin-bottom: 20rpx;\r\n\t\t\t}\r\n\r\n\t\t\t.chat-items-body {\r\n\t\t\t\twidth: 100%;\r\n\r\n\t\t\t\t.chat-items-icon {\r\n\t\t\t\t\twidth: 84rpx;\r\n\t\t\t\t\theight: 84rpx;\r\n\t\t\t\t\tborder-radius: 42rpx;\r\n\r\n\t\t\t\t\t.user-img {\r\n\t\t\t\t\t\tborder-radius: 42rpx;\r\n\t\t\t\t\t\twidth: 100%;\r\n\t\t\t\t\t}\r\n\t\t\t\t}\r\n\r\n\t\t\t\t.chat-items-msg {\r\n\t\t\t\t\t// flex: 1;\r\n\t\t\t\t\tposition: relative;\r\n\t\t\t\t\tmax-width: 500rpx;\r\n\t\t\t\t\tmargin: 0 20rpx;\r\n\t\t\t\t\tborder-radius: 8rpx;\r\n\t\t\t\t\tpadding: 20rpx;\r\n\t\t\t\t\tfont-size: 32rpx;\r\n\t\t\t\t\tcolor: #333;\r\n\t\t\t\t\tbackground-color: #FFF;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t.on {\r\n\t\t\t\t\tbackground-color: #CFE2FF;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t.on::after {\r\n\t\t\t\t\tcontent: '';\r\n\t\t\t\t\tposition: absolute;\r\n\t\t\t\t\tright: -10rpx;\r\n\t\t\t\t\ttop: 32rpx;\r\n\t\t\t\t\twidth: 0;\r\n\t\t\t\t\theight: 0;\r\n\t\t\t\t\tborder-top: 10rpx solid transparent;\r\n\t\t\t\t\tborder-left: 10rpx solid #CFE2FF;\r\n\t\t\t\t\tborder-bottom: 10rpx solid transparent;\r\n\t\t\t\t}\r\n\r\n\t\t\t\t.un::before {\r\n\t\t\t\t\tcontent: '';\r\n\t\t\t\t\tposition: absolute;\r\n\t\t\t\t\tleft: -10rpx;\r\n\t\t\t\t\ttop: 32rpx;\r\n\t\t\t\t\twidth: 0;\r\n\t\t\t\t\theight: 0;\r\n\t\t\t\t\tborder-top: 10rpx solid transparent;\r\n\t\t\t\t\tborder-right: 10rpx solid #FFF;\r\n\t\t\t\t\tborder-bottom: 10rpx solid transparent;\r\n\t\t\t\t}\r\n\t\t\t}\r\n\r\n\t\t\t.chat-start {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tflex-direction: row;\r\n\t\t\t\tjustify-content: flex-start;\r\n\t\t\t\talign-items: flex-start;\r\n\t\t\t}\r\n\r\n\t\t\t.chat-end {\r\n\t\t\t\tdisplay: flex;\r\n\t\t\t\tflex-direction: row;\r\n\t\t\t\tjustify-content: flex-end;\r\n\t\t\t\talign-items: flex-start;\r\n\t\t\t}\r\n\t\t}\r\n\r\n\t\t.bottom {\r\n\t\t\twidth: 100vw;\r\n\t\t\theight: 20rpx;\r\n\t\t}\r\n\t}\r\n\r\n\t// 聊天信息框 end\r\n\r\n\t// 发布消息框 start\r\n\t.bottom-input-wrapper {\r\n\t\tposition: fixed;\r\n\t\tleft: 0;\r\n\t\tbottom: 0;\r\n\t\twidth: 92%;\r\n\t\theight: 80rpx;\r\n\t\tbackground-color: #FFF;\r\n\t\tpadding: 20rpx 4%;\r\n\t\tz-index: 999;\r\n\r\n\t\t.input {\r\n\t\t\theight: 80rpx;\r\n\t\t\tfont-size: 32rpx;\r\n\t\t\tcolor: #333;\r\n\t\t\tbackground-color: #F6F7FB;\r\n\t\t\tborder-radius: 40rpx;\r\n\t\t\tpadding-right: 150rpx;\r\n\t\t\tpadding-left: 40rpx;\r\n\t\t}\r\n\r\n\t\t.input-class {\r\n\t\t\tfont-size: 32rpx;\r\n\t\t\tcolor: #969AB0;\r\n\t\t}\r\n\r\n\t\t.publish-btn {\r\n\t\t\tposition: absolute;\r\n\t\t\ttop: 20rpx;\r\n\t\t\tright: 20rpx;\r\n\t\t\theight: 80rpx;\r\n\t\t\tpadding: 0 40rpx;\r\n\t\t\ttext-align: center;\r\n\t\t\tline-height: 80rpx;\r\n\t\t\tborder-radius: 40rpx;\r\n\t\t\tbackground-color: #0F6EFF;\r\n\t\t\tfont-size: 32rpx;\r\n\t\t\tfont-weight: 700;\r\n\t\t\tcolor: #FFF;\r\n\t\t}\r\n\t}\r\n\r\n\t// 发布消息框 end\r\n</style>\r\n","import mod from \"-!../../../../soft/HBuilderX.3.3.5.20211229/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../soft/HBuilderX.3.3.5.20211229/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../soft/HBuilderX.3.3.5.20211229/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../soft/HBuilderX.3.3.5.20211229/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../soft/HBuilderX.3.3.5.20211229/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../soft/HBuilderX.3.3.5.20211229/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../soft/HBuilderX.3.3.5.20211229/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../soft/HBuilderX.3.3.5.20211229/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../soft/HBuilderX.3.3.5.20211229/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./customer-service.vue?vue&type=style&index=0&id=a7c1c04e&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../soft/HBuilderX.3.3.5.20211229/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../soft/HBuilderX.3.3.5.20211229/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/dist/cjs.js??ref--8-oneOf-1-1!../../../../soft/HBuilderX.3.3.5.20211229/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/loaders/stylePostLoader.js!../../../../soft/HBuilderX.3.3.5.20211229/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-2!../../../../soft/HBuilderX.3.3.5.20211229/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../soft/HBuilderX.3.3.5.20211229/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/sass-loader/dist/cjs.js??ref--8-oneOf-1-4!../../../../soft/HBuilderX.3.3.5.20211229/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../soft/HBuilderX.3.3.5.20211229/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/vue-loader/lib/index.js??vue-loader-options!../../../../soft/HBuilderX.3.3.5.20211229/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./customer-service.vue?vue&type=style&index=0&id=a7c1c04e&lang=scss&scoped=true&\"","// extracted by mini-css-extract-plugin\n    if(module.hot) {\n      // 1645266855236\n      var cssReload = require(\"E:/soft/HBuilderX.3.3.5.20211229/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/hmr/hotModuleReplacement.js\")(module.id, {\"hmr\":true,\"publicPath\":\"../../\",\"locals\":false});\n      module.hot.dispose(cssReload);\n      module.hot.accept(undefined, cssReload);\n    }\n  "],"sourceRoot":""}